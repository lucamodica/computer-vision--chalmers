function [r,J] = LinearizeReprojErr(P_1,P_2,X_j,x_1j,x_2j)

    % row for P1
    J1 = [
        (((P_1(1, :) * X_j) / (P_1(3, :) * X_j)^2) * P_1(3, :)) - ((1 / (P_1(3, :) * X_j)) * P_1(1, :));
        (((P_1(2, :) * X_j) / (P_1(3, :) * X_j)^2) * P_1(3, :)) - ((1 / (P_1(3, :) * X_j)) * P_1(2, :))
    ];

    % row for P2
    J2 = [
        (((P_2(1, :) * X_j) / (P_2(3, :) * X_j)^2) * P_2(3, :)) - ((1 / (P_2(3, :) * X_j)) * P_2(1, :));
        (((P_2(2, :) * X_j) / (P_2(3, :) * X_j)^2) * P_2(3, :)) - ((1 / (P_2(3, :) * X_j)) * P_2(2, :))
    ];

    J = [J1; J2];

    [err, r] = ComputeReprojectionError(P_1, P_2, X_j, x_1j, x_2j);
